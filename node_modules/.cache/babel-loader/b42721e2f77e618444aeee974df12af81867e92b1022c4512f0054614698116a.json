{"ast":null,"code":"import _classPrivateFieldLooseBase from \"/home/buck/Documents/software/formulate_graphql/node_modules/@babel/runtime/helpers/esm/classPrivateFieldLooseBase.js\";\nimport _classPrivateFieldLooseKey from \"/home/buck/Documents/software/formulate_graphql/node_modules/@babel/runtime/helpers/esm/classPrivateFieldLooseKey.js\";\nvar _jsxFileName = \"/home/buck/Documents/software/formulate_graphql/src/components/input.component.tsx\";\nimport React from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _findCompletions = /*#__PURE__*/_classPrivateFieldLooseKey(\"findCompletions\");\nvar _setCompletionState = /*#__PURE__*/_classPrivateFieldLooseKey(\"setCompletionState\");\nvar _getCompletionListElement = /*#__PURE__*/_classPrivateFieldLooseKey(\"getCompletionListElement\");\nexport class CompletionInput extends React.Component {\n  constructor(props) {\n    super(props);\n    Object.defineProperty(this, _getCompletionListElement, {\n      value: _getCompletionListElement2\n    });\n    Object.defineProperty(this, _setCompletionState, {\n      value: _setCompletionState2\n    });\n    Object.defineProperty(this, _findCompletions, {\n      value: _findCompletions2\n    });\n    this.lastSearch = '';\n    this.listName = '';\n    if (!this.props.id) {\n      this.props.id;\n    }\n    this.listName = (this.props.id || 'completions-' + Math.random()) + '-list';\n    this.state = {\n      completions: null\n    };\n  }\n  get inputHandler() {\n    var _this$props;\n    if ((_this$props = this.props) !== null && _this$props !== void 0 && _this$props.debounce && this.props.debounce > 0) return CompletionInput.debounceHandler(_classPrivateFieldLooseBase(this, _findCompletions)[_findCompletions], this.props.debounce, this);else return _classPrivateFieldLooseBase(this, _findCompletions)[_findCompletions].bind(this);\n  }\n  /* eslint-disable-next-line @typescript-eslint/ban-types -- we explicitly expect any function */\n  static debounceHandler(fn) {\n    let delay = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 50;\n    let self = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : window;\n    var timer; /* eslint-disable-line no-var -- explicitly refers to entire function */\n    return function () {\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      // console.log('debounce',...args);\n      clearTimeout(timer);\n      timer = setTimeout(() => {\n        // console.log('trigger',...args);\n        try {\n          fn.apply(self, args);\n        } catch (e) {\n          console.error(e);\n        }\n      }, delay);\n    };\n  }\n  render() {\n    console.log(\"rendering...\");\n    const completionList = this.state.completions ? _classPrivateFieldLooseBase(this, _getCompletionListElement)[_getCompletionListElement](this.state.completions) : null;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      id: this.props.id,\n      className: \"completionInput\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        list: this.listName,\n        placeholder: \"Search...\",\n        onInput: this.inputHandler,\n        autoFocus: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 5\n      }, this), completionList]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 4\n    }, this);\n  }\n}\nfunction _findCompletions2(event) {\n  // console.log(\"updating this.state.completions\",this)\n  const lastSearch = this.lastSearch;\n  const search = this.lastSearch = event.target.value;\n  if (!search) {\n    _classPrivateFieldLooseBase(this, _setCompletionState)[_setCompletionState](null);\n  } else if (this.props.getCompletions) {\n    let lastCompletions = null;\n    if (lastSearch.startsWith(search)) {\n      lastCompletions = this.state.completions;\n    } else {\n      _classPrivateFieldLooseBase(this, _setCompletionState)[_setCompletionState](null); //user has pressed backspace => delete the old completions\n    }\n\n    _classPrivateFieldLooseBase(this, _setCompletionState)[_setCompletionState](this.props.getCompletions(search, lastCompletions));\n  }\n}\nfunction _setCompletionState2(completions) {\n  this.setState({\n    completions\n  });\n}\nfunction _getCompletionListElement2(completions) {\n  const list = completions.map(c => /*#__PURE__*/_jsxDEV(\"option\", {\n    className: \"completion\",\n    value: c.name,\n    children: c.html || c.name\n  }, c.key || c.name, false, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 5\n  }, this));\n  return /*#__PURE__*/_jsxDEV(\"datalist\", {\n    id: this.listName,\n    className: \"completionList\",\n    children: list\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 85,\n    columnNumber: 11\n  }, this);\n}\nexport default CompletionInput;","map":{"version":3,"names":["React","CompletionInput","Component","constructor","props","lastSearch","listName","id","Math","random","state","completions","inputHandler","debounce","debounceHandler","bind","fn","delay","self","window","timer","args","clearTimeout","setTimeout","apply","e","console","error","render","log","completionList","event","search","target","value","getCompletions","lastCompletions","startsWith","setState","list","map","c","name","html","key"],"sources":["/home/buck/Documents/software/formulate_graphql/src/components/input.component.tsx"],"sourcesContent":["import React from 'react'\n\ntype CompletionList=Array<{name:string,key?:string,html?:JSX.Element|JSX.Element[]}>\nexport type GetCompletions<T extends CompletionList>=(search:string,lastCompletions:T|null)=>T|null\n\nexport interface Props<T extends CompletionList> {\n\tid?:string,\n\tdebounce?:number,\n\tgetCompletions:GetCompletions<T>\n}\n\ninterface State<T extends CompletionList>{\n\tcompletions:T|null\n}\n\nexport class CompletionInput<T extends CompletionList> extends React.Component<Props<T>,State<T>> {\n\n\n\tpublic lastSearch='';\n\tprivate listName='';\n\n\tconstructor(props:Props<T>){\n\t\tsuper(props);\n\n\t\tif(!this.props.id){\n\t\t\tthis.props.id\n\t\t}\n\t\tthis.listName=(this.props.id || 'completions-'+Math.random())+'-list'\n\t\tthis.state={completions:null};\n\t}\n\t\n\tget inputHandler(){\n\t\tif(this.props?.debounce && this.props.debounce>0)\n\t\t\treturn CompletionInput.debounceHandler(this.#findCompletions,this.props.debounce,this);\n\t\telse\n\t\t\treturn this.#findCompletions.bind(this);\n\t}\n\n\t#findCompletions(event:React.ChangeEvent<HTMLInputElement>){\n\t\t// console.log(\"updating this.state.completions\",this)\n\t\tconst lastSearch=this.lastSearch;\n\t\tconst search=this.lastSearch=event.target.value;\n\t\tif(!search){\n\t\t\tthis.#setCompletionState(null);\n\t\t}else if(this.props.getCompletions){\n\t\t\tlet lastCompletions=null;\n\t\t\tif(lastSearch.startsWith(search)){\n\t\t\t\tlastCompletions=this.state.completions;\n\t\t\t}else{\n\t\t\t\tthis.#setCompletionState(null); //user has pressed backspace => delete the old completions\n\t\t\t}\n\t\t\tthis.#setCompletionState(this.props.getCompletions(search,lastCompletions));\n\t\t}\n\t}\n\n\t#setCompletionState(completions:State<T>[\"completions\"]){\n\t\tthis.setState({completions});\n\t}\n\n\n\n\t/* eslint-disable-next-line @typescript-eslint/ban-types -- we explicitly expect any function */\n\tstatic debounceHandler<F extends (...args:any[])=>any>(fn:F,delay=50,self:any=window) {\n\t\tvar timer:ReturnType<typeof setInterval>; /* eslint-disable-line no-var -- explicitly refers to entire function */\n\t\treturn (...args:Parameters<F>)=>{\n\t\t\t// console.log('debounce',...args);\n\t\t\tclearTimeout(timer);\n\t\t\ttimer=setTimeout(()=>{\n\t\t\t\t// console.log('trigger',...args);\n\t\t\t\ttry{fn.apply(self,args)}catch(e){console.error(e)}\n\t\t\t},delay);\n\t\t}\n\t}\n   \n\t#getCompletionListElement(completions:CompletionList):JSX.Element{\n\t\tconst list=completions.map(\n\t\t\t(c)=>(\n\t\t\t\t<option \n\t\t\t\t\tkey={c.key||c.name} \n\t\t\t\t\tclassName='completion' \n\t\t\t\t\tvalue={c.name}\n\t\t\t\t>{c.html||c.name}</option>\n\t\t\t)\n\t\t);\n\t\treturn (<datalist id={this.listName} className=\"completionList\">{list}</datalist>)\n\t}\n\trender(){\t\n\t\tconsole.log(\"rendering...\")\t\n\t\tconst completionList=(this.state.completions ? this.#getCompletionListElement(this.state.completions) : null);\n\t\treturn (\n\t\t\t<div id={this.props.id} className=\"completionInput\">\n\t\t\t\t<input type=\"text\" list={this.listName} placeholder=\"Search...\" onInput={this.inputHandler} autoFocus></input>\n\t\t\t\t{completionList}\n\t\t\t</div>\n\t\t);\n\t}\n\n\n}\n\n\nexport default CompletionInput;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}